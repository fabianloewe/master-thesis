[#theoretische-grundlagen]
== Theoretische Grundlagen

Zunächst werden die theoretischen Grundlagen zum _Information Hiding_ aufbereitet.
Basierend darauf wird auf die Analyse von Merkmalen eingegangen,
die durch die Benutzung von Information Hiding entstehen können.

=== Information Hiding

Die Methodik des Information Hiding beschreibt allgemein das Verstecken von Daten in anderen Daten.
In das _Cover_-Medium werden Daten eingebettet,
wodurch ein verändertes Medium mit den eingebetteten Daten (allgemein als _Stego_-Medium bekannt) entsteht.
Die eingebetteten Daten werden je nach Kontext als _Einbettungsdaten_, _Nachricht_ oder auch _Payload_ bezeichnet.
Zum Information Hiding gehören die Techniken der _Steganografie_, des __Watermarking__s (im weiteren Text als Wasserzeichen benannt) und
die _Kryptografie_.
Die Kryptografie wird in dieser Arbeit nicht weiter als eigenständiges Verfahren beleuchtet,
da dabei nicht versucht wird, das originale Medium scheinbar unverändert zu lassen. cite:[petitcolas_information_1999,agrawal_survey_2015]

Neben den genannten Techniken fällt auch das Einbetten in die Struktur des Cover-Mediums zum Information Hiding,
wobei zumeist Metadaten überschrieben oder Einbettungsdaten einfach an festgelegte Stellen im Medium geschrieben werden.

==== Anwendungsgebiete

Die Einbettung in die Struktur ist im Allgemeinen spezifisch auf das Format angepasst.
In ein Bild im JFIF-Format cite:[hamilton_eric_jpeg_1992] lässt sich beispielsweise eine Nachricht an Stelle eines Vorschaubildes (oder _Thumbnail_) einbetten.
Außerdem zählen zu dieser Art von Information Hiding das Anfügen von Daten nach einem End-Marker des Dateiformats wie dem EOI-Marker in JPEGs.
Die oftmals simple Natur dieser Verfahren erlaubt eine schnelle Implementierung bei hohe Kapazität an Einbettungsdaten.
So können zum Beispiel beliebig große Nachrichten an ein JPEG angefügt werden.
Lediglich beim Warten für die Anzeige des Bilds oder bei der Übertragung kann die Größe auffallen.

Bei der Steganografie liegt der Fokus auf dem effektiven Verstecken der Existenz von eingebetteten Daten,
sodass nur die versendende und die empfangende Person von der Nachricht wissen und diese auch nur entschlüsseln können.
Wie bereits in der Einleitung beschrieben, wurde diese Technik schon lange vor digitalen Systemen eingesetzt. 
cite:[agrawal_survey_2015]

Wasserzeichen weisen dagegen andere Anwendungsgebiete auf.
Sie werden beispielsweise für das Fingerprinting, den Urheberrechtsschutz,
die Verifikation der Authentizität von Inhalten (z.B. auf Social Media-Plattformen) oder in medizinischen Programmen angewandt.
Daraus hervorgehend müssen Wasserzeichen anderen Kriterien genügen, als es Stego- oder Struktur-Verfahren tun.
cite:[begum_digital_2020]

<<<

[#theorie-kriterien]
==== Kriterien

Die Techniken des Information Hiding werden nach drei Kriterien eingeordnet:

.Kriterien für das Information Hiding cite:[begum_digital_2020]
[horizontal%ordered]
Kapazität: :: Beschreibt, welche Größe an Daten in das Cover eingebettet werden kann
Robustheit: :: Beschreibt, wie sicher das Verfahren vor Angriffen durch Dritte ist
Nicht-Detektierbarkeit: :: Beschreibt, wie einfach die Verwendung des Verfahrens auf das Cover durch Dritte zu entdecken ist

.Verteilung von Kapazität, Robustheit und Nicht-Detektierbarkeit cite:[fridrich_applications_1999]
image::abbildung_inf-hide_kriterien.png[]

Zu den naiven Verfahren können die Struktureinbettung und einfache Stego-Algorithmen zugeordnet werden.
Die sichereren Stego-Verfahren weisen eine geringere Kapazität bei höherer Unerkennbarkeit auf.
Wasserzeichen-Verfahren haben einen klaren Fokus auf Robustheit,
wobei Kapazität und Unerkennbarkeit eine untergeordnete Rolle spielen.
Dies ist darin begründet, dass Wasserzeichen üblicherweise nur Identifikationsinformationen beinhalten.

[#theorie-verfahren]
==== Verfahren

Die klassischen Verfahren der Steganografie können in zwei Domänen unterteilt werden: der _Raum_- und der _Frequenz_-Domäne.
In der Raumdomäne werden die Pixel des Cover-Bildes so verändert, dass die Nachricht darin versteckt ist und wieder extrahiert werden kann.
In der Frequenz-Domäne werden die Komprimierungstabellen des Bildes genutzt.
Die gezielte Manipulation der darin enthaltenen Werte erlaubt es, dort eine Nachricht zu verstecken.
Neben den klassischen Verfahren werden zudem vermehrt auch neuronale Netze insbesondere für Wasserzeichen eingesetzt.

<<<

Die wichtigsten Verfahren werden nachfolgend kurz vorgestellt, ohne einen Anspruch auf Vollständigkeit zu erheben:

.Raumdomäne
Least Significant Bit (LSB):: Bei dieser Technik wird der am wenigsten wichtige Bit eines Pixel in den Wert eines Bits aus der einzubettenden Nachricht geändert.
Die Veränderung ist für das menschliche Auge minimal und daher durch reine Observation kaum zu entdecken.
Neben des am wenigsten relevanten Bits kann auch der am zweitwenigsten oder drittwenigsten, usw. relevante Bit zur Einbettung genutzt werden.
Dies führt zu einer Erhöhung der Kapazität bei einer immer leichteren Detektierbarkeit.
Bei Farbbildern kann die Technik auf jeden der drei Farbkanäle sowie auf den Alpha-Kanal angewendet werden.

Intermedia Significant Bit (ISB):: Diese Verbesserung der LSB-Methode sucht pro Pixel in einem bestimmten Bit-Intervall nach dem optimalen Bit,
dessen Veränderung am wenigsten Einfluss auf die Detektierbarkeit ausüben dürfte.
Varianten dieser Methode passen die restlichen Bits außerdem so an, dass der Farbwert des Pixels dem ursprünglichen entspricht.

XOR-Methode:: Ähnlich dem LSB-Verfahren werden XOR-Operationen auf die am wenigsten relevanten Bits der Pixel angewendet.
Ein Vorteil gegenüber LSB-Verfahren ist, dabei die Nachricht nicht einfach durch Extraktion direkt lesbar ist.
Eine Möglichkeit der Implementierung wird von Joshi und Yadav in cite:[joshi_new_2016] vorgestellt.

Patchwork:: Diese Technik nutzt eine pseudo-zufällige Einbettung von sich wiederholenden Mustern mittels einer Gauss-Verteilung.
Dabei werden zwei Patches A und B pseudo-zufällig ausgewählt, wobei A verblasst und B verdunkelt wird.

[#theorie-verfahren-frequenz]
.Frequenzdomäne
Discrete Cosine Transform  (DCT):: Die DCT-Methode nutzt die DCT-Tabelle von JPEG-Bildern,
indem das Cover-Bild in mehrere Blöcke unterteilt wird. In diese Blöcke wird die Einbettung ausgeführt.
Üblicherweise werden die niederen Frequenzen zur Manipulation genutzt,
da diese durch einfachste Verfahren wie Sichtprüfung durch Menschen schwerer detektierbar sind.

Discrete Wavelet Transform (DWT):: Die Frequenzen des Bilds werden in sogenannte Wavelets umgewandelt,
welche für die Signalverarbeitung oder Bildkomprimierung relevant sind.
Die dabei verwendeten Koeffizienten können in mehrere Ebenen unterteilt werden,
welche verschiedene Manipulationen erlauben.

Singular Value Decomposition (SVD):: Verfahren der SVD-Technik nutzen Eigenschaften der Eigendekomposition
einer symmetrischen Matrix mit nicht-negativen Eigenwerten sowie deren Beziehungen zu den Koeffizienten.

Weitere Techniken werden insbesondere in der Forschung neu- und weiterentwickelt.
Auch Hybrid-Verfahren der beiden Domänen sind möglich.
In dieser Arbeit soll allerdings nur ein Überblick über die gängigsten Techniken verschafft werden.
Einen guten Einblick in das breitere Forschungsfeld und vertiefende Informationen zu den Kurzbeschreibungen liefern
Begum und Uddin in cite:[begum_digital_2020].

<<<

Zum Bereich des Information Hidings gehört auch die Einbettung in die Struktur des Cover-Bildes, z.B. die folgenden Methoden:

.Struktur-Verfahren
Einbetten in Metadaten:: Hierbei wird die Nachricht in ein Feld der Metadaten des Cover-Bildes geschrieben.
Dabei kann es sich um das Kommentar-Feld oder auch das Modell-Feld in den EXIF-Metadaten handeln.
Für größere Nachrichten wie Payloads muss jedoch insbesondere bei EXIF-Feldern der durch Bildverarbeitungsprogramme 
erwartete Datentyp beachtet werden.

Anfügen ans Dateiende:: Die Nachricht wird nach dem End-Marker der Bilddatei eingefügt.
Die meisten Bilddarstellungsprogramme ignorieren alle weiteren Anhänge,
wodurch ein Payload für einen menschlichen Betrachter nicht sichtbar wird.
Durch Forensik-Programme ist dies jedoch einfach zu erkennen.

Ändern des Vorschaubilds:: Eine Nachricht kann an Stelle eines Vorschaubilds in das Cover-Bild eingefügt werden. 
Eine einfache Detektion durch Sicht kann dann nur erfolgen, falls das Vorschaubild dargestellt werden soll.

Struktur-Verfahren können noch in vielen weiteren Variationen eingesetzt werden.
Außerdem können Struktur-Verfahren mit Raum- und Frequenz-Verfahren kombiniert werden, um beispielsweise die Kapazität zu erhöhen.

=== Merkmalsanalyse

Die _Merkmalsanalyse_ im Kontext dieser Arbeit beschäftigt sich mit der Suche nach und der Analyse von gefundenen Merkmalen
im Zusammenhang mit steganografisch manipulierten Daten. Damit ist sie der sogenannten _Attribution_ zugehörig.
Diese beschäftigt sich grundsätzlich mit dem Ziel,
den oder die Verursachenden von böswilliger Cyberaktivität wie zum Beispiel das Eindringen in Rechnersysteme zu identifizieren.
Dabei kann es zunächst um die Rückverfolgung des Angriffs auf die von den Angreifenden verwendeten Systeme gehen.
Daraus können dann Rückschlüsse wie die Herkunft der böswilligen Aktoren gezogen werden.
Oftmals werden Angriffe im Auftrag einer Drittpartei durchgeführt,
die möglicherweise über die Angreifer identifizierbar ist. cite:[lin_attribution_2016]

Die Merkmalsanalyse in dieser Arbeit fokussiert sich nur auf die Identifikation von Programmen, 
die für die Einbettung von Daten mittels Information Hiding oder im Speziellen Steganografie genutzt wurden, 
was auch als _Steganalyse_ bezeichnet wird.
Eine solche Merkmalsanalyse wird durchgeführt,
nachdem ein erhärteter Verdacht auf den Einsatz von Stego durch vorherige Schritte der Steganalyse festgestellt wurde.
Je nach erwartetem Stego-Verfahren werden unterschiedliche Analyseverfahren angewendet und miteinander kombiniert,
um die Einbettungssoftware so detailliert wie möglich zu identifizieren.
Konkrete Methoden werden in den <<ergebnisse-merkmale,Ergebnissen>> vorgestellt.

[#theorie-metriken]
==== Metriken

Für die Auswertung des Fingerprintings von Stego-Tools werden die folgenden drei Metriken verwendet,
welche unter anderem in cite:[hossin_review_2015] beschrieben sind.

Genauigkeit (_Accuracy_):: Beschreibt die Rate der korrekten Zuordnungen im Vergleich zur Gesamtzahl an Bildpaaren.
+
Formel: stem:[(tp + tn)/(tp + fp + tn + fn)]

Präzision (_Precision_):: Beschreibt die Rate der korrekt zugeordneten Bilder zu den insgesamt zu einem Stego-Tool zugeordneten Bildern.
+
Formel: stem:[(tp)/(tp+fn)]

Sensitivität (_Recall_):: Beschreibt die Rate der korrekt zugeordneten Bilder zu den insgesamt korrekten Positiven und
Negativen für ein Stego-Tool.
+
Formel: stem:[(tp)/(tp+tn)]

Dabei stehen die Variablen für:

.Wahrheitsmatrix mit TP, FP, FN und TN
[cols="1h,2*"]
|===
| | Echte Positive | Echte Negative

| Erwartete Positive
| Wahr-Positive / _True positive_ (stem:[tp])
| Falsch-Positive / _False positive_ (stem:[fp])

| Erwartete Negative
| Falsch-Negative / _False negative_ (stem:[fn])
| Wahr-Negative / _True negative_ (stem:[tn])

|===
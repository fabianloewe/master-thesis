== Ergebnisse

Die folgenden Ergebnisse sind jeweils zu einem Abschnitt in <<_methodik,Methodik>> zugeordnet. 

[#ergebnisse-malware]
=== Malware-Vorkommnisse im Zusammenhang mit Steganografie

In der folgenden Tabelle sind die ersten fünf Einträge der zuvor gesammelten Malware-Vorkommnisse zu sehen.

.Auszug aus Malware-Daten
[%header%breakable,format=csv,separator=;]
|===
include::../assets/tables/malware-samples.csv[]
|===

****
Der Ausschnitt aus der vollständigen Tabellen (<<tabellen_malware,siehe Anhang>>) wurden mit den folgenden Schritten erstellt:

.Erstellung des Tabellenauszugs
. Gesamttabelle nach Werten in der Spalte `Created` absteigend sortieren
. Zeilen, deren `Name` dem regülären Ausdruck `[\"{}@]` entsprichen, entfernen
. Spalte `Page Content` entfernen
. Ersten 5 Ergebnisse auswählen
****

Der Auszug zeigt fünf Malware-Vorkommnisse, die erstmals im Zeitraum von Juni 2021 bis Januar 2022 registriert wurden.
Die Malware _Zox_ und _Raindrop_ erfuhren Aktualisierungen im März 2023 und waren zumindest bis zu diesem Zeitpunkt noch aktiv. Jede der gezeigten Malwares wurde für die Ausführung auf dem Betriebssystem Windows entwickelt. Drei Malwares nutzen Bitmap-Bilder, wobei davon eines auch auf JPEG-Bilder zurückgreift, während nur _Zox_ PNG-Bilder verwendet.
Der gezeigte Auszug ist dabei jedoch voll representativ, wie die nächsten Auswertungen zeigen.

.Anzahl der Malwares pro Stegangraphie-Art
|===
|Steganographie-Art|Anzahl der Malwares

| LSB
| 4

| XOR
| 2

| End of File
| 2

| Unknown
| 29
|===
.**TODO**: 
* Mit aktuellen Daten füllen! 
* Mit Vorkommen pro Jahr angeben, um Shift zu LSB zu zeigen

.Anzahl der Malwares pro Plattform
|===
|Plattform|Anzahl der Malwares

| Windows
| 27

| Android
| 1

| macOS
| 1

| Linux
| 2

| Unbekannt
| 16
|===
.**TODO**: 
Mit aktuellen Daten füllen! 

.Anzahl der Malwares pro Cover-Typ
|===
|Cover-Typ|Anzahl der Malwares

|JPG
|5

|PNG
|10

|BMP
|4

|GIF
|0

|TIFF
|0

|PDF
|2

|Unbekannt
|24
|===
.**TODO**: 
Mit aktuellen Daten füllen! 

[#ergebnisse_softwares]
=== Steganografie- und Wasserzeichen-Software

Die anschließenden Unterabschnitte listen die in der Recherche gefundenen Softwares auf und
vergleicht diese nach ihren Funktionen in einer Gesamtübersichtstabelle miteinander.

[#ergebnisse_softwares_stego]
==== Übersicht zu Steganografie-Software

In den folgenden Tabellen werden die Steganografie-Programme vorgestellt.
Die erste Tabelle zeigt die Tools, die auf Desktop-Plattformen wie Windows, macOS und Linux laufen,
während die zweite die Apps auf den mobilen Plattformen Android und iOS präsentiert.
Beide Tabellen folgen dem gleichen Schema. Zunächst wird die Software,
dann ihre untertützten Plattformen, ihrer Steganografie-Domäne (siehe Theorie), ihre unterstützten Steganografie-Algorithmen und 
schließlich zugehörige Referenzen benannt.

.Desktop-Tools
. jsteg cite:[noauthor_dominicbreukerstego-toolkit_nodate, verma_detecting_2022]
. outguess cite:[noauthor_dominicbreukerstego-toolkit_nodate, verma_detecting_2022]
. steghide cite:[noauthor_dominicbreukerstego-toolkit_nodate, verma_detecting_2022]
. stegify
. f5 cite:[noauthor_dominicbreukerstego-toolkit_nodate, verma_detecting_2022]
. stegpy cite:[noauthor_dominicbreukerstego-toolkit_nodate]
. lsbsteg
. stegolsb

.Desktop-Anwendungen
|===
|Name|Plattformen|Domäne|Algorithmen|Referenzen

|jsteg
|Windows, macOS, Linux
|Raum
|LSB
|cite:[noauthor_dominicbreukerstego-toolkit_nodate, verma_detecting_2022]

|steghide
|Windows, macOS, Linux
|Raum
|LSB
|cite:[noauthor_dominicbreukerstego-toolkit_nodate, verma_detecting_2022]

|stegpy
|Windows, macOS, Linux
|Raum
|LSB
|cite:[noauthor_dominicbreukerstego-toolkit_nodate]

|outguess
|Windows, macOS, Linux
|Frequenz
|Outguess
|cite:[noauthor_dominicbreukerstego-toolkit_nodate, verma_detecting_2022]

|f5
|Windows, macOS, Linux
|Frequenz
|F5
|cite:[noauthor_dominicbreukerstego-toolkit_nodate, verma_detecting_2022]

|===

.Mobile-Apps
. PixelKnot
. Passlok
. MobiStego
. PocketStego
. Steganography-Meznik
. Pictograph

.Mobile Anwendungen
|===
|Name|Plattformen|Domäne|Algorithmen|Referenzen

|PixelKnot
|Android
|Frequenz
|F5
|cite:[newman_stegoappdb_2019]

|Passlok Privacy
|Android
|Frequenz
|
|cite:[newman_stegoappdb_2019]

|MobiStego
|Android
|Raum
|LSB
|cite:[newman_stegoappdb_2019]

|Steganography-Meznik
|Android
|Raum
|LSB
|cite:[newman_stegoappdb_2019]

|Pictograph
|iOS
|Raum
|LSB
|cite:[newman_stegoappdb_2019]

|===

[#ergebnisse_softwares_wz]
==== Übersicht zu Wasserzeichen-Software

Der aktuelle Stand der Forschung zeigt, dass insbesondere die Verwendung von neuronalen Netzen zur Einbettung von Wasserzeichen in Bildern den aktuell höchsten 
Schutz vor Angriffen in diesem Fachbereich bieten. Da unsichtbare Wasserzeichen im Gegensatz zu Steganografie-Tools oder auch -Malware einen Anwendungsbereich im Umfeld von Medienkonzernen finden und weniger von Endbenutzern verwendet werden, lassen sich vor allem komplexe wissenschaftlich belegte Implementierungen finden. 

. https://github.com/Akshat-14/DWT-DCT-SVD[DwtDcdSvd] cite:[navas_dwt-dct-svd_2008]
. https://github.com/tancik/StegaStamp[StegaStamp] cite:[tancik_stegastamp_2020]
. https://github.com/facebookresearch/ssl_watermarking[SSL Watermarking] cite:[fernandez_watermarking_2022]
. https://github.com/facebookresearch/stable_signature[Stable Signature] cite:[fernandez_stable_2023]
. https://github.com/YuxinWenRick/tree-ring-watermark[Tree-Ring Watermarks] cite:[wen_tree-ring_2023]
. https://github.com/ShieldMnt/invisible-watermark[invisible-watermark]
. https://github.com/rosuH/EasyWatermark[Easy Watermark]

|===
|Name|Plattformen|Domäne|Algorithmen|Referenzen

|DwtDcdSvd
|Windows, macOS, Linux
|Frequenz
|
|cite:[navas_dwt-dct-svd_2008]

|StegaStamp
|Windows, macOS, Linux
|Frequenz
|Neuronales Netzwerk
|cite:[tancik_stegastamp_2020]

|SSL Watermarking
|Windows, macOS, Linux
|
|Neuronales Netzwerk
|cite:[fernandez_watermarking_2022]

|Stable Signature
|Windows, macOS, Linux
|
|Neuronales Netzwerk
|cite:[fernandez_stable_2023]

|Tree-Ring Watermarks
|Windows, macOS, Linux
|
|Neuronales Netzwerk
|cite:[wen_tree-ring_2023]

|Tree-Ring Watermarks
|Android
|
|Neuronales Netzwerk
|https://github.com/rosuH/EasyWatermark[Easy Watermark]

|===

==== Gesamtübersicht

.TODO:
* Diagramm der Gesamtübersicht mit:
** Domäne
** Kategorie (Desktop, App, WZ)

[#ergebnisse_bilddatensatz]
=== Verwendeter Bild-Datensatz

Der ausgewählte Datensatz beinhaltet Cover-Stego-Bildpaare der zuvor beschriebenen mobilen Stego-Apps.
Diese setzen hauptsächlich Steganografie in der Raumdomäne ein, wobei PixelKnot in der Frequenz-Domäne arbeitet.
Um den Einsatz von Information Hiding durch Malware besser widerzuspiegeln, wurde aus den Cover-Bildern des Datensatzes
zudem Stego-Bilder mit den Verfahren der Struktur-Einbettung erstellt.

Die Einstellung des Suchformulars der StegoAppDB wurde wie folgt vorgenommen:

.Einstellung StegoAppDB
image::stegoappdb-verwendet.png[Einstellung StegoAppDB]

Es wurden lediglich immer das erste Gerät pro Gerätetyp ausgewählt und die manuelle Belichtungsdauer nicht selektiert, da sonst die Größe des Datensatzes um nahezu das Zehnfache angestiegen wäre. (siehe <<appendix_stegoappdb-nicht-verwendet>>)

=== Übersicht von Merkmalen steganografischer Bilddaten

==== Metadatenvergleich

Der Metadatenvergleich wurde wie in der Vorstellung der <<methodik-analysen-metadaten,Analyse von Metadaten>> durchgeführt.
Dabei zeigte sich das, in einigen Fällen Metadaten durch die Stego-Apps entfernt wurden.
Es konnten aber keine neuen Metadaten identifiziert werden, die Rückschlüsse auf die verwendete Stego-App zulassen würden.

TODO:
* Füge Ausgabe des Metadatenvergleichs ein

[#ergebnisse-dateigroessen]
==== Dateigrößenunterschiede

Die folgenden Dateigrößendifferenzen konnten mit der
<<methodik-analysen-dateigroesse,im Methodikteil vorgestellten Analyse>> ermittelt werden.

image::file-size_mobistego.png[Dateigrößenunterschiede MobiStego]

Das Diagramm zeigt, dass der Größenunterschied für MobiStego bei 3060 Cover- und Stego-Bild
sich im positiven Bereich zwischen 2 % bis 35 % bewegt.
Dabei gibt es einige Ausreißer mit einem Unterschied bis zu 50 %,
sehr wenige bis 60 % und lediglich ein Unterschied von 70 % vorkommt.

image::file-size_passlok.png[Dateigrößenunterschiede Passlok]

Bei Passlok wurden 1530 Bildpaare untersucht, wobei sich die Verteilung im Bereich von 0,1 % bis 0,25 % mit Ausreißern
bis 0,38 % befindet.

image::file-size_pictograph.png[Dateigrößenunterschiede Pictograph]

Für Pictograph standen 4800 Bildpaare bereit, welche einen Unterschied von 16 % bis 50 % mit Ausreißern bis 65 % aufweisen.

image::file-size_pixelknot.png[Dateigrößenunterschiede PixelKnot]

PixelKnot weist als einzige App bei 3060 Bildpaaren eine Verkleinerung der Dateigröße auf,
weshalb sich der Dateigrößenunterschied um -0,1 % bis -3 % mit Ausreißern bis -4,3 % bewegt.

image::file-size_pocketstego.png[Dateigrößenunterschiede PocketStego]

PocketStego befindet bei 3060 Bildpaaren im Bereich von 3 % bis 20 % mit Ausreißern bis 33 %.

image::file-size_steganographym.png[Dateigrößenunterschiede SteganographyM]

Bei SteganographM sind die größten Unterschiede in der Dateigröße vernehmbar.
Die Unterschiede fallen in den Bereich von 19 % bis 70 % mit Ausreißern bis zu 130 %.

Im nächsten Diagramm ist die Verteilung der prozentualen Dateigrößenunterschiede der Stego-Apps im Vergleich zueinander
dargestellt.

image::file-size_raw.png[Dateigrößenunterschiede mit Ausreißern]

Dabei zeigt sich, dass PixelKnot im negativen Bereich keine Schnittmenge und SteganographyM im positiven Bereich
ab mindestens 80 % keine Überschneidungen mit anderen Apps aufweist.

Wie in den Diagrammen zu den einzelnen Apps bereits zu sehen war,
gibt am unteren und oberen Ende der meisten Apps einige Ausreißer.
Diese unteren und oberen 5 % wurden im folgenden Schnitt ausgeklammert,
um Apps mit einer höheren Wahrscheinlichkeit für einen bestimmten Dateigrößenmunterschied eher zu detektieren als
die Ausreißer weniger wahrscheinlicher Apps. Nach dieser Bereinigung sieht die Verteilung wie folgt aus:

image::file-size_summary.png[Dateigrößenunterschiede ohne Ausreißer]

Daraus ergeben sich die folgenden Bereiche, die über die Erkennung des Dateigrößenunterschieds abgedeckt werden können:

. -2,63 % bis -0,25% => PixelKnot
. 0,02 % bis 0,23 % => Passlok
. 4,09 % bis 5,44 % => PocketStego
. 5,44 % bis 18,68 % => PocketStego oder MobiStego
. 18,68 % bis 20,88 % => MobiStego
. 20,88 % bis 24 % => MobiStego oder SteganographyM
. 24 % bis 34,6 % => MobiStego oder SteganographyM oder Pictograph
. 34,6 % bis 47,67 % => SteganographyM oder Pictograph
. 47,67 % oder mehr => Pictograph

Durch die fünf Intervalle 1, 2, 3, 5 und 9 lassen sich die betrachteten Stego-Apps basierend auf dem Datensatz eindeutig zu ordnen.
In den anderen Fällen ist es lediglich eine von zwei oder drei Apps.

[#ergebnisse-lsb-extraktion]
==== LSB-Extraktion

Mittels der <<methodik-analysen-lsb-extraktion,LSB-Extraktion>> wurde insbesondere nach Signaturen in der eingebetteten Nachricht gesucht.
Um dies zu erreichen, wurden zunächst die genauen Einbettungsstrategien ermittelt.
Dies erfolgte durch Probieren möglicher Konfigurationen mit den ersten 10 Bildern,
auf die eine Stego-App angewendet wurde.
Eine Konfiguration besteht aus:

Einbettungsmethode _method_:: Die verwendete Stego-App zum Einbetten
+
*Optionen*: Die Namen der Stego-Apps als String

Farbkanäle _channels_:: Die zu überprüfenden Farbkanäle
+
*Optionen*: Jegliche Kombination aus `R`, `G`, `B`, `A`

LSBs _bits_:: Die zu extrahierenden Least Significant Bits pro gewählten Farbkanal
+
*Optionen*: 1, 2, 4

Bit-Reihenfolge _endian_:: Die bei der Zusammensetzung der Nachricht zu beachtende Bit-Reihenfolge
+
*Optionen*: `little` für Little-Endian oder `big` für Big-Endian

Iterationsrichtung _direction_:: Die Richtung, in der über die Pixel iteriert werden soll
+
*Optionen*: `row` für die Iteration über die Zeile bzw. Bildweite oder `col[umn]` für die Iteration über die Spalte bzw. Bildhöhe

Der Ablauf wurde wie folgt umgesetzt:
====
. Erhalte Konfiguration
. Für jedes Stego-Bild
.. Suche und lese Originalnachricht aus
.. Extrahiere eingebettete Nachricht aus LSBs der Konfiguration folgend
.. Suche in extrahierter Nachricht nach Original
*** Wenn Suche erfolgreich war, füge Konfiguration und Index der gefundenen Nachricht der Ergebnisliste hinzu
. Entferne Duplikate aus Ergebnisliste und gib zurück:
** Wenn Länge der Ergebnisliste 1 ist, gib Erfolgsrate und Konfiguration zurück
** Wenn Länge der Ergebnisliste größer 1 ist, gib Erfolgsrate und Ergebinsliste mit passenden Konfigurationen zurück
** Ansonsten, gib Erfolgsrate und `None` zurück
====

Mit folgendem Ergebnis:

[%header,format=csv]
|===
rate,method,channels,bits,endian,direction,index
1.0,MobiStego,RGB,2,big,row,3
1.0,PocketStego,B,1,big,column,0
|===

Dies deckt sich mit den Erkenntnissen in cite:[chen_tackling_2018].
Da PocketStego und MobiStego die einzigen beiden Stego-Apps sind,
die einen nicht-zufälligen LSB-Einbettungspfad verwenden,
konnten auch nur diese erkannt werden.
Steganography_M dagegen nutzt einen pseudo-randomisierten Einbettungspfad und
Pictograph und PixelKnot setzen Steganografie in der <<theorie-verfahren-frequenz,Frequenz-Domäne>> ein und
sind daher so nicht detektierbar.

Durch Vergleichen der extrahierten Nachrichten basierend auf den erkannten Konfigurationen konnten dann
die folgenden Signaturen, wie auch in cite:[chen_tackling_2018] beschrieben, entdeckt werden:

* *MobiStego*:
** `@!#` (ASCII-Zeichen): Markiert den Beginn der Nachricht
** `#!@` (ASCII-Zeichen): Markiert das Ende der Nachricht

* *PocketStego*:
** `b'\x00'` (Byte): Markiert das Ende der Nachricht. Es handelt sich dabei um den Null-Byte.

=== Konfiguration des Detektors

Aus den vorherigen Ergebnissen lassen sich die Regeln ableiten, welche der Detektor zur Analyse nutzen wird.
Die dazugehörige Datei ist im <<anhang-regeln,Anhang>> beigefügt.

Die Regeldatei listet zunächst alle Tools auf, die detektiert werden können.
Es folgt der erste Regelblock, indem die Dateigrößen entsprechend den Intervallen
aus den <<ergebnisse-dateigroessen,Ergebnissen der Dateigrößenvergleiche>> als Regeln abgebildet sind.
Nach den Regeln `ISA.MobiStego.File-Size-Diff`, `ISA.PocketStego.File-Size-Diff`, `ISA.PocketStego-MobiStego.File-Size-Diff`,
`ISA.MobiStego-SteganographyM.File-Size-Diff` und `ISA.MobiStego-SteganographyM-Pictograph.File-Size-Diff`
wird die <<ergebnisse-lsb-extraktion,LSB-Signatur>> von MobiStego und respektive PocketStego überprüft.

Die Namen der Regeln bestehen immer aus dem Kürzel `ISA` für _Image Stego App_, gefolgt von der oder den spezifischen App(s) und
dem überprüften Merkmal abgekürzt in Englisch. Dadurch werden Namensräume für die Merkmale mit Zuordnung zu den Stego-Apps geschaffen.
Die Benennung ist aber funktional nur als Text abgebildet und könnte beliebig anderweitig vorgenommen werden.

Die Regeln sind im Rahmen dieser Arbeit alle gleich gewichtet,
da eine statistische Auswertung jeder einzelnen Regel nötig ist und dies den Umfang sprengen würde.
Ein sinnvoller Ansatz dazu wird im <<_ausblick,Ausblick>> beschrieben.

=== Auswertung des Detektors

Mit den zuvor vorgestellten Regeln wurde jedes der 18570 Cover-Stego-Bildpaare durchlaufen,
um die verwendete Stego-App zu bestimmen. Die Ergebnisse wurden in Wahrheitsmatrizen dargestellt.
Dabei ist immer links oben die Anzahl der wahr-positiven (TP), rechts oben der falsch-positiven (FP),
links unten der falsch-negativen (FN) und rechts unten der wahr-falschen (TN) Detektionen wiederzufinden.

==== Auswertung mit binärer Betrachtung

Es wurde zunächst überprüft, ob eine Erkennung stattfand oder nicht.
Jede Detektion mit einer Gewichtung größer als 0 wurde somit als positiv eingestuft.

image::eval-detect_bool_mobistego.png[]

image::eval-detect_bool_passlok.png[]

image::eval-detect_bool_pictograph.png[]

image::eval-detect_bool_pixelknot.png[]

image::eval-detect_bool_pocketstego.png[]

image::eval-detect_bool_steganographym.png[]

Dabei sind die folgenden statistischen Werte herausgekommen.

[format=csv]
|===
include::../assets/tables/eval-detect_bool.csv[]
|===

==== Auswertung unter Bezugnahme auf Gewichtung

In der zweiten Auswertung wurden ausschließlich Detektionen als positiv eingestuft,
wenn sie unter allen Detektionen für ein bestimmtes Cover-Stego-Paar die höchste Gewichtung vorweisen konnten.
Bei gleicher Gewichtung wurde die Detektion aufgrund mangelnder Eindeutig als negativ eingestuft.

image::eval-detect_max_mobistego.png[]

image::eval-detect_max_passlok.png[]

image::eval-detect_max_pictograph.png[]

image::eval-detect_max_pixelknot.png[]

image::eval-detect_max_pocketstego.png[]

image::eval-detect_max_steganographym.png[]

Hierbei ergaben sich die folgenden statistischen Werte.

[format=csv]
|===
include::../assets/tables/eval-detect_max.csv[]
|===

'''

Es zeigt sich ein relevanter Unterschied in der Betrachtungsweise.
Zählen ausschließlich die höchstgewichteten Detektionen, können sehr gute Ergebnisse erzielt werden.
...